{"version":3,"file":"201-39718bb3c8acab63ca34.js","mappings":"gKAEIA,E,+EAQJ,EAPkB,WAIhB,OAHKA,IACHA,GAAgBC,EAAAA,EAAAA,GAAWC,gHAEtBF,G,UCcT,EArBoB,SAACG,GAEnB,GACEA,EAAUC,MAAK,SAACC,GACd,OAAOA,EAAKC,KAAKC,MAAM,eAGzB,MAAO,+BAGT,IAAIC,EAAW,EAMf,OALAL,EAAUM,SAAQ,SAACJ,GACbA,EAAKC,KAAKC,MAAM,eAClBC,GAAsBH,EAAKK,aAG3BF,EAAW,EACN,+BACK,gC,UCqIhB,EAtIa,SAAC,GAAkB,IAAhBG,EAAe,EAAfA,SACd,GAA4BC,EAAAA,EAAAA,UAAS,QAA9BC,EAAP,KAAeC,EAAf,KACMC,GAAYC,EAAAA,EAAAA,KAAY,SAACC,GAAD,OAAWA,EAAMF,aAC/C,GAAyBC,EAAAA,EAAAA,KAAY,SAACC,GAAD,OAAWA,EAAMC,QAA9CC,EAAR,EAAQA,MAAOC,EAAf,EAAeA,MACTC,GAAWC,EAAAA,EAAAA,OAEjBC,EAAAA,EAAAA,YAAU,WACR,GAAIR,EAAW,CACb,IAAMS,EAAQ,mCAAG,8FACMC,IADN,cAERC,mBAAmB,CAAEX,UAAWA,IAFxB,2CAAH,qDAIdS,OAED,CAACT,IAEJ,IAAMY,EAAa,kBAAMN,GAASO,EAAAA,EAAAA,QAE5BC,EAAiB,SAACxB,GAAD,OAAU,SAACyB,GAChCT,GAASU,EAAAA,EAAAA,IAAmB1B,EAAM2B,SAASF,EAAEG,OAAOC,WAnBzB,wCAuB7B,WAA8BC,GAA9B,uEACEA,EAAMC,iBAEFjB,EAAM,IACRL,EAAU,WACJuB,EAAeC,EAAYnB,GACjCE,GAASkB,EAAAA,EAAAA,IAAapB,EAAOkB,KAE7BvB,EAAU,iBARd,4CAvB6B,sBAmC7B,OACE,gBAAC0B,EAAA,EAAD,CAAOC,KAAK,KAAKC,KAAM/B,EAAUgC,OAAQhB,GACvC,gBAACa,EAAA,SAAD,CAAcI,aAAW,IACzB,gBAACJ,EAAA,OAAD,KACE,uBAAKK,UAAU,+DACb,uBAAKA,UAAU,kBAAf,WACA,uBAAKA,UAAU,eAAf,OACA,uBAAKA,UAAU,wBAAf,SACA,uBAAKA,UAAU,iCAAf,YACA,uBAAKA,UAAU,WAEhB1B,EAAM,GACL,uBAAK0B,UAAU,iBACZ1B,EAAM2B,KAAI,SAACzC,EAAM0C,GAChB,OACE,uBACEF,UAAU,wEACVG,IAAKD,GAEL,uBAAKF,UAAU,yBACb,uBAAKA,UAAU,2BACb,gBAAC,EAAAI,EAAD,CACEJ,UAAU,OACVK,IAAK7C,EAAKC,KACV6C,OAAOC,EAAAA,EAAAA,GAAS/C,EAAK8C,UAGzB,uBAAKN,UAAU,yCACb,0BAAKxC,EAAKC,MACV,qBAAGuC,UAAU,cACVxC,EAAKoC,MAAQ,SAAWpC,EAAKoC,QAIpC,uBAAKI,UAAU,cACb,yBACEA,UAAU,4BACVQ,KAAK,SACLC,IAAK,EACLC,aAAclD,EAAKK,SACnB8C,SAAU3B,EAAexB,MAG7B,uBAAKwC,UAAU,iCACZY,EAAAA,EAAAA,GAAYpD,EAAKqD,MAAO,QAE3B,uBAAKb,UAAU,gCACZY,EAAAA,EAAAA,GAAYpD,EAAKqD,MAAQrD,EAAKK,SAAU,QAE3C,uBAAKmC,UAAU,cACb,0BACEA,UAAU,yCACVc,QAAS,kBAAMtC,GAASuC,EAAAA,EAAAA,IAAevD,MAFzC,WAYV,uBAAKwC,UAAU,oCAAf,uBAID1B,EAAM,IACL,qBAAG0B,UAAU,yBAAb,uIAKF,uBAAKA,UAAU,yDACb,sBAAIA,UAAU,WAAd,SACA,sBAAIA,UAAU,YAAWY,EAAAA,EAAAA,GAAYrC,EAAO,SAE9C,uBAAKyB,UAAU,mCACb,0BACEA,UAAS,kBACP1B,EAAM,GAAK,aAAe,iBADnB,aAGT0C,SAAqB,YAAXhD,IAAyBM,EAAM,GACzCwC,QArHmB,6CAuHP,YAAX9C,EAAuB,UAAY,uBAEtC,0BACEgC,UAAU,8BACVgB,SAAqB,YAAXhD,EACV8C,QAAShC,GAHX","sources":["webpack://venom-dolls/./src/utils/stripejs.js","webpack://venom-dolls/./src/utils/getShipping.js","webpack://venom-dolls/./src/components/Cart.js"],"sourcesContent":["import { loadStripe } from \"@stripe/stripe-js\";\n\nlet stripePromise;\nconst getStripe = () => {\n  if (!stripePromise) {\n    stripePromise = loadStripe(process.env.GATSBY_STRIPE_PUBLISHABLE_KEY);\n  }\n  return stripePromise;\n};\n\nexport default getStripe;\n","const getShipping = (lineItems) => {\n  // contains a hoodie\n  if (\n    lineItems.find((item) => {\n      return item.name.match(/(Hoodie)/);\n    })\n  ) {\n    return \"shr_1KaWd3KtGQ4ZHKav4Zr4Ih38\";\n  }\n  // contains more than one tee shirt\n  let teeCount = 0;\n  lineItems.forEach((item) => {\n    if (item.name.match(/(T-Shirt)/)) {\n      teeCount = teeCount + item.quantity;\n    }\n  });\n  if (teeCount > 1) {\n    return \"shr_1KaWd3KtGQ4ZHKav4Zr4Ih38\";\n  } else return \"shr_1KaWdNKtGQ4ZHKav4g0p9r6i\";\n};\n\nexport default getShipping;\n","import React, { useEffect, useState } from \"react\";\nimport Modal from \"react-bootstrap/Modal\";\nimport { GatsbyImage, getImage } from \"gatsby-plugin-image\";\nimport { useSelector, useDispatch } from \"react-redux\";\n\nimport getStripe from \"../utils/stripejs\";\n\nimport {\n  removeFromCart,\n  adjustItemQuantity,\n  checkoutCart,\n  toggleCartOpen,\n} from \"../actions\";\n\nimport getShipping from \"../utils/getShipping\";\nimport formatPrice from \"../utils/formatPrice\";\n\nconst Cart = ({ cartOpen }) => {\n  const [status, setStatus] = useState(\"idle\");\n  const sessionId = useSelector((store) => store.sessionId);\n  const { items, total } = useSelector((store) => store.cart);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (sessionId) {\n      const redirect = async () => {\n        const stripe = await getStripe();\n        stripe.redirectToCheckout({ sessionId: sessionId });\n      };\n      redirect();\n    }\n  }, [sessionId]);\n\n  const toggleCart = () => dispatch(toggleCartOpen());\n\n  const adjustQuantity = (item) => (e) => {\n    dispatch(adjustItemQuantity(item, parseInt(e.target.value)));\n  };\n\n  // dispatches create session call\n  async function handleCheckout(event) {\n    event.preventDefault();\n\n    if (items[0]) {\n      setStatus(\"loading\");\n      const shippingRate = getShipping(items);\n      dispatch(checkoutCart(items, shippingRate));\n    } else {\n      setStatus(\"missing-items\");\n    }\n  }\n\n  return (\n    <Modal size=\"xl\" show={cartOpen} onHide={toggleCart}>\n      <Modal.Header closeButton />\n      <Modal.Body>\n        <div className=\"row mx-2 justify-content-between align-items-center fw-bold\">\n          <div className=\"col-4 col-md-6\">MY CART</div>\n          <div className=\"col-2 small\">QTY</div>\n          <div className=\"col-2 col-md-1 small\">PRICE</div>\n          <div className=\"d-none d-md-block col-1 small\">SUBTOTAL</div>\n          <div className=\"col-1\"></div>\n        </div>\n        {items[0] ? (\n          <div className=\"cart-products\">\n            {items.map((item, index) => {\n              return (\n                <div\n                  className=\"row mx-2 border-bottom py-3 align-items-start justify-content-between\"\n                  key={index}\n                >\n                  <div className=\"col-4 col-md-6 d-flex\">\n                    <div className=\"d-none d-md-block col-4\">\n                      <GatsbyImage\n                        className=\"mr-3\"\n                        alt={item.name}\n                        image={getImage(item.image)}\n                      />\n                    </div>\n                    <div className=\"col-md-8 mt-2 mt-md-3 ms-md-4 ps-md-3\">\n                      <h6>{item.name}</h6>\n                      <p className=\"fst-italic\">\n                        {item.size && \"Size: \" + item.size}\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"col-2 mt-2\">\n                    <input\n                      className=\"w-100 w-md-50 text-center\"\n                      type=\"number\"\n                      min={1}\n                      defaultValue={item.quantity}\n                      onChange={adjustQuantity(item)}\n                    />\n                  </div>\n                  <div className=\"d-none d-md-block col-1 mt-2\">\n                    {formatPrice(item.price, \"NZD\")}\n                  </div>\n                  <div className=\"col-2 col-md-1 mt-2 fw-bold\">\n                    {formatPrice(item.price * item.quantity, \"NZD\")}\n                  </div>\n                  <div className=\"col-1 mt-2\">\n                    <button\n                      className=\"text-end btn btn-outline-dark border-0\"\n                      onClick={() => dispatch(removeFromCart(item))}\n                    >\n                      X\n                    </button>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        ) : (\n          <div className=\"m-2 p-4 border-top border-bottom\">\n            Your cart is empty.\n          </div>\n        )}\n        {items[0] && (\n          <p className=\"small fst-italic mt-2\">\n            Please note: As our merch is all hand printed by a local business,\n            please allow up to 2-3 weeks for your purchase to be dispatched.\n          </p>\n        )}\n        <div className=\"d-flex py-3 w-50 me-2 ms-auto justify-content-between\">\n          <h6 className=\"fw-bold\">TOTAL</h6>\n          <h6 className=\"fw-bold\">{formatPrice(total, \"NZD\")}</h6>\n        </div>\n        <div className=\"d-flex mt-2 justify-content-end\">\n          <button\n            className={`px-4 me-3 btn ${\n              items[0] ? \"btn-danger\" : \"btn-secondary\"\n            } rounded-0`}\n            disabled={status === \"loading\" || !items[0]}\n            onClick={handleCheckout}\n          >\n            {status === \"loading\" ? \"LOADING\" : \"PROCEED TO CHECKOUT\"}\n          </button>\n          <button\n            className=\"px-3 btn btn-dark rounded-0\"\n            disabled={status === \"loading\"}\n            onClick={toggleCart}\n          >\n            KEEP SHOPPING\n          </button>\n        </div>\n      </Modal.Body>\n    </Modal>\n  );\n};\n\nexport default Cart;\n"],"names":["stripePromise","loadStripe","process","lineItems","find","item","name","match","teeCount","forEach","quantity","cartOpen","useState","status","setStatus","sessionId","useSelector","store","cart","items","total","dispatch","useDispatch","useEffect","redirect","getStripe","redirectToCheckout","toggleCart","toggleCartOpen","adjustQuantity","e","adjustItemQuantity","parseInt","target","value","event","preventDefault","shippingRate","getShipping","checkoutCart","Modal","size","show","onHide","closeButton","className","map","index","key","G","alt","image","getImage","type","min","defaultValue","onChange","formatPrice","price","onClick","removeFromCart","disabled"],"sourceRoot":""}