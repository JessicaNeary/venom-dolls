{"version":3,"file":"79-3a5330921b6773f5c000.js","mappings":"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","sources":["webpack://venom-dolls/./node_modules/@stripe/stripe-js/dist/stripe.esm.js","webpack://venom-dolls/./src/utils/stripejs.js","webpack://venom-dolls/./src/utils/getShipping.js","webpack://venom-dolls/./src/components/Cart.js"],"sourcesContent":["var V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\n\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.29.0\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\n\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\n\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n// own script injection.\n\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\n\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now();\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };","import { loadStripe } from \"@stripe/stripe-js\";\n\nlet stripePromise;\nconst getStripe = () => {\n  if (!stripePromise) {\n    stripePromise = loadStripe(process.env.GATSBY_STRIPE_PUBLISHABLE_KEY);\n  }\n  return stripePromise;\n};\n\nexport default getStripe;\n","const getShipping = (lineItems) => {\n  // contains a hoodie\n  if (\n    lineItems.find((item) => {\n      return item.name.match(/(Hoodie)/);\n    })\n  ) {\n    return \"shr_1KaWd3KtGQ4ZHKav4Zr4Ih38\";\n  }\n  // contains more than one tee shirt\n  let teeCount = 0;\n  lineItems.forEach((item) => {\n    if (item.name.match(/(T-Shirt)/)) {\n      teeCount = teeCount + item.quantity;\n    }\n  });\n  if (teeCount > 1) {\n    return \"shr_1KaWd3KtGQ4ZHKav4Zr4Ih38\";\n  } else return \"shr_1KaWdNKtGQ4ZHKav4g0p9r6i\";\n};\n\nexport default getShipping;\n","import React, { useEffect, useState } from \"react\";\nimport Modal from \"react-bootstrap/Modal\";\nimport { GatsbyImage, getImage } from \"gatsby-plugin-image\";\nimport { useSelector, useDispatch } from \"react-redux\";\n\nimport getStripe from \"../utils/stripejs\";\n\nimport {\n  removeFromCart,\n  adjustItemQuantity,\n  checkoutCart,\n  toggleCartOpen,\n} from \"../actions\";\n\nimport getShipping from \"../utils/getShipping\";\nimport formatPrice from \"../utils/formatPrice\";\n\nconst Cart = ({ cartOpen }) => {\n  const [status, setStatus] = useState(\"idle\");\n  const sessionId = useSelector((store) => store.sessionId);\n  const { items, total } = useSelector((store) => store.cart);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (sessionId) {\n      const redirect = async () => {\n        const stripe = await getStripe();\n        stripe.redirectToCheckout({ sessionId: sessionId });\n      };\n      redirect();\n    }\n  }, [sessionId]);\n\n  const toggleCart = () => dispatch(toggleCartOpen());\n\n  const adjustQuantity = (item) => (e) => {\n    dispatch(adjustItemQuantity(item, parseInt(e.target.value)));\n  };\n\n  // dispatches create session call\n  async function handleCheckout(event) {\n    event.preventDefault();\n\n    if (items[0]) {\n      setStatus(\"loading\");\n      const shippingRate = getShipping(items);\n      dispatch(checkoutCart(items, shippingRate));\n    } else {\n      setStatus(\"missing-items\");\n    }\n  }\n\n  return (\n    <Modal size=\"xl\" show={cartOpen} onHide={toggleCart}>\n      <Modal.Header closeButton />\n      <Modal.Body>\n        <div className=\"row mx-2 justify-content-between align-items-center fw-bold\">\n          <div className=\"col-4 col-md-6\">MY CART</div>\n          <div className=\"col-2 small\">QTY</div>\n          <div className=\"col-2 col-md-1 small\">PRICE</div>\n          <div className=\"d-none d-md-block col-1 small\">SUBTOTAL</div>\n          <div className=\"col-1\"></div>\n        </div>\n        {items[0] ? (\n          <div className=\"cart-products\">\n            {items.map((item, index) => {\n              return (\n                <div\n                  className=\"row mx-2 border-bottom py-3 align-items-start justify-content-between\"\n                  key={index}\n                >\n                  <div className=\"col-4 col-md-6 d-flex\">\n                    <div className=\"d-none d-md-block col-4\">\n                      <GatsbyImage\n                        className=\"mr-3\"\n                        alt={item.name}\n                        image={getImage(item.image)}\n                      />\n                    </div>\n                    <div className=\"col-md-8 mt-2 mt-md-3 ms-md-4 ps-md-3\">\n                      <h6>{item.name}</h6>\n                      <p className=\"fst-italic\">\n                        {item.size && \"Size: \" + item.size}\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"col-2 mt-2\">\n                    <input\n                      className=\"w-100 w-md-50 text-center\"\n                      type=\"number\"\n                      min={1}\n                      defaultValue={item.quantity}\n                      onChange={adjustQuantity(item)}\n                    />\n                  </div>\n                  <div className=\"d-none d-md-block col-1 mt-2\">\n                    {formatPrice(item.price, \"NZD\")}\n                  </div>\n                  <div className=\"col-2 col-md-1 mt-2 fw-bold\">\n                    {formatPrice(item.price * item.quantity, \"NZD\")}\n                  </div>\n                  <div className=\"col-1 mt-2\">\n                    <button\n                      className=\"text-end btn btn-outline-dark border-0\"\n                      onClick={() => dispatch(removeFromCart(item))}\n                    >\n                      X\n                    </button>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        ) : (\n          <div className=\"m-2 p-4 border-top border-bottom\">\n            Your cart is empty.\n          </div>\n        )}\n        {items[0] && (\n          <p className=\"small fst-italic mt-2\">\n            Please note: As our merch is all hand printed by a local business,\n            please allow up to 2-3 weeks for your purchase to be dispatched.\n          </p>\n        )}\n        <div className=\"d-flex py-3 w-50 me-2 ms-auto justify-content-between\">\n          <h6 className=\"fw-bold\">TOTAL</h6>\n          <h6 className=\"fw-bold\">{formatPrice(total, \"NZD\")}</h6>\n        </div>\n        <div className=\"d-flex mt-2 justify-content-end\">\n          <button\n            className={`px-4 me-3 btn ${\n              items[0] ? \"btn-danger\" : \"btn-secondary\"\n            } rounded-0`}\n            disabled={status === \"loading\" || !items[0]}\n            onClick={handleCheckout}\n          >\n            {status === \"loading\" ? \"LOADING\" : \"PROCEED TO CHECKOUT\"}\n          </button>\n          <button\n            className=\"px-3 btn btn-dark rounded-0\"\n            disabled={status === \"loading\"}\n            onClick={toggleCart}\n          >\n            KEEP SHOPPING\n          </button>\n        </div>\n      </Modal.Body>\n    </Modal>\n  );\n};\n\nexport default Cart;\n"],"names":["V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","stripePromise","loadScript","params","Promise","resolve","reject","window","Stripe","console","warn","script","scripts","document","querySelectorAll","concat","i","length","test","src","findScript","queryString","advancedFraudSignals","createElement","headOrBody","head","body","Error","appendChild","injectScript","addEventListener","error","initStripe","maybeStripe","args","startTime","stripe","apply","undefined","_registerWrapper","name","version","registerWrapper","stripePromise$1","then","loadCalled","err","_len","arguments","Array","_key","Date","now","loadStripe","process","lineItems","find","item","match","teeCount","forEach","quantity","cartOpen","useState","status","setStatus","sessionId","useSelector","store","cart","items","total","dispatch","useDispatch","useEffect","redirect","getStripe","redirectToCheckout","toggleCart","toggleCartOpen","adjustQuantity","e","adjustItemQuantity","parseInt","target","value","event","preventDefault","shippingRate","getShipping","checkoutCart","Modal","size","show","onHide","closeButton","className","map","index","key","G","alt","image","getImage","type","min","defaultValue","onChange","formatPrice","price","onClick","removeFromCart","disabled"],"sourceRoot":""}